generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// User Model
model User {
  // Primary Key
  id          String @id @default(cuid())
  // Supabase Key
  supabaseUid String @unique @map("supabase_uid")

  // User Info
  email     String @unique
  firstName String @map("first_name")
  lastName  String @map("last_name")

  // Roles
  role       String  @default("staff")
  department String?
  isActive   Boolean @default(true) @map("is_active")

  // Timestamps
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")
  lastLoginAt DateTime? @map("last_login_at")

  // Relationships
  managedWarehouses Warehouse[] @relation("manager")

  @@map("users")
}

// Warehouse Model
model Warehouse {
  // Primary Key
  id String @id @default(cuid())

  // Identification
  code       String  @unique
  name       String
  location   String
  address    String
  city       String
  country    String
  postalCode String? @map("postal_code")

  // status
  capacity Int
  isActive Boolean @default(true) @map("is_active")

  // Manager Assignment
  managerId String? @map("manager_id")

  // Sustainability Metrics
  carbonPerSqMeter Float?  @map("carbon_per_sq_meter")
  energySource     String? @map("energy_source") // e.g., "Solar", "Grid", "Hybrid"
  solarPercentage  Float?  @map("solar_percentage")

  // Timestamps
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // Relationships
  manager User? @relation("manager", fields: [managerId], references: [id])

  @@map("warehouses")
}
